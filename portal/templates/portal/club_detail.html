{% extends "portal/base_home.html" %}
{% load static %}

{% block title %}{{ club.name }} | Chi ti·∫øt CLB{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'portal/css/club_detail.css' %}">
{% endblock %}

{% block content %}
<section class="club-detail">

  <!-- AC2: N√∫t quay v·ªÅ danh s√°ch -->
  <div class="back-row">
    <a class="back-btn" href="{% url 'portal:club_list' %}">‚Üê Quay v·ªÅ danh s√°ch CLB</a>
  </div>

  <!-- HERO: Th√¥ng tin CLB + 1 ·∫£nh (tham kh·∫£o ·∫£nh m·∫´u 3) -->
  <div class="hero-wrap">
    <div>
      <div class="hero-badges">
        {% if club.field %}
          <span class="pill pill-green">üè∑Ô∏è {{ club.get_field_display }}</span>
        {% endif %}
        <span class="pill pill-gray">üìå {{ club.get_status_display }}</span>
      </div>

      <h1 class="hero-title">{{ club.name }}</h1>

      <div class="hero-meta">
        <div class="meta-item">
          <div class="meta-k">Khoa/ƒê∆°n v·ªã</div>
          <div class="meta-v">{% if club.faculty %}{{ club.faculty }}{% else %}‚Äî{% endif %}</div>
        </div>

        <div class="meta-item">
          <div class="meta-k">L·ªãch sinh ho·∫°t</div>
          <div class="meta-v">
            {% if club.meeting_schedule %}{{ club.meeting_schedule }}{% else %}‚Äî{% endif %}
          </div>
        </div>

        <div class="meta-item">
          <div class="meta-k">Li√™n h·ªá</div>
          <div class="meta-v">
            {% if club.contact_email %}‚úâÔ∏è {{ club.contact_email }}<br>{% endif %}
            {% if club.contact_phone %}üìû {{ club.contact_phone }}<br>{% endif %}
            {% if club.contact_facebook %}üåê <a href="{{ club.contact_facebook }}" target="_blank" rel="noopener">Facebook/Website</a>{% endif %}
            {% if not club.contact_email and not club.contact_phone and not club.contact_facebook %}‚Äî{% endif %}
          </div>
        </div>
      </div>

      <p class="hero-desc">
        {% if club.description %}
          {{ club.description }}
        {% else %}
          Ch∆∞a c√≥ m√¥ t·∫£ cho CLB n√†y.
        {% endif %}
      </p>
    </div>

    <div class="hero-image">
      {% if club.cover_image_url %}
        <img src="{{ club.cover_image_url }}" alt="·∫¢nh CLB">
      {% else %}
        <img src="{% static 'portal/img/truong.jpg' %}" alt="·∫¢nh m·∫∑c ƒë·ªãnh">
      {% endif %}
      <div class="img-label">University Clubs</div>
    </div>
  </div>

  <!-- S·ª∞ KI·ªÜN ƒê√É T·ªî CH·ª®C (tham kh·∫£o ·∫£nh m·∫´u 4) -->
  <div class="section" style="margin-top: 22px;">
    <h2 class="section-title">S·ª± ki·ªán ƒë√£ t·ªï ch·ª©c</h2>

    {% if events %}
      <div class="events-grid">
        {% for e in events %}
          <div class="event-card">
            <div class="event-img">
              {% if e.image_url %}
                <img src="{{ e.image_url }}" alt="·∫¢nh s·ª± ki·ªán">
              {% else %}
                <img src="{% static 'portal/img/truong.jpg' %}" alt="·∫¢nh m·∫∑c ƒë·ªãnh">
              {% endif %}
            </div>

            <div class="event-body">
              {% if e.category %}
                <span class="event-cat">{{ e.category }}</span>
              {% else %}
                <span class="event-cat">Ho·∫°t ƒë·ªông CLB</span>
              {% endif %}
              <h3 class="event-title">{{ e.title }}</h3>
              <p class="event-desc">
                {% if e.description %}
                  {{ e.description }}
                {% else %}
                  (Ch∆∞a c√≥ m√¥ t·∫£ s·ª± ki·ªán.)
                {% endif %}
              </p>
            </div>

            <div class="event-side">
              <div class="event-date">
                {% if e.event_date %}
                  {{ e.event_date|date:"d" }}
                  <small>{{ e.event_date|date:"m/Y" }}</small>
                {% else %}
                  --
                  <small>Ch∆∞a c√≥ ng√†y</small>
                {% endif %}
              </div>
              <div style="color:#6b7280; font-weight:700;">
                {{ club.name }}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p style="color:#6b7280; margin:0;">CLB ch∆∞a c√≥ s·ª± ki·ªán n√†o ƒë∆∞·ª£c c·∫≠p nh·∫≠t.</p>
    {% endif %}
  </div>

  <!-- BAN CH·ª¶ NHI·ªÜM CLB (tham kh·∫£o ·∫£nh m·∫´u 5) -->
  <div class="section">
    <h2 class="section-title">Ban ch·ªß nhi·ªám C√¢u L·∫°c B·ªô</h2>

    {% if bcn_members %}
      <div class="bcn-grid">
        {% for m in bcn_members %}
          <div class="bcn-card">
            <div class="bcn-avatar">
              {% if m.full_name %}{{ m.full_name|slice:":1"|upper }}{% else %}{{ m.user.username|slice:":1"|upper }}{% endif %}
            </div>
            <div>
              <p class="bcn-name">
                {% if m.full_name %}{{ m.full_name }}{% else %}{{ m.user.username }}{% endif %}
              </p>
              <p class="bcn-sub">
                @{{ m.user.username }}
                {% if m.user.email %} ‚Ä¢ {{ m.user.email }}{% endif %}
              </p>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p style="color:#6b7280; margin:0;">CLB ch∆∞a c√≥ BCN ƒë∆∞·ª£c g√°n.</p>
    {% endif %}
  </div>

  <!-- LI√äN H·ªÜ (tham kh·∫£o ·∫£nh m·∫´u cu·ªëi) -->
  <div class="section" style="padding: 0; border: 0; box-shadow: none; background: transparent;">
    <div class="contact-wrap">
      <div class="contact-left">
        <h3>Li√™n h·ªá t√†i tr·ª£</h3>
        <p style="margin: 0; opacity: .95;">
          Vui l√≤ng ƒë·ªÉ l·∫°i th√¥ng tin, ch√∫ng t√¥i s·∫Ω li√™n h·ªá v·ªõi b·∫°n s·ªõm!
        </p>

        <div class="line">‚úâÔ∏è {% if club.contact_email %}{{ club.contact_email }}{% else %}(Ch∆∞a c√≥ email){% endif %}</div>
        <div class="line">üìû {% if club.contact_phone %}{{ club.contact_phone }}{% else %}(Ch∆∞a c√≥ s·ªë ƒëi·ªán tho·∫°i){% endif %}</div>
        <div class="line">üåê {% if club.contact_facebook %}<a href="{{ club.contact_facebook }}" target="_blank" rel="noopener">Facebook/Website</a>{% else %}(Ch∆∞a c√≥ link){% endif %}</div>
      </div>

      <!-- Form UI (ch·ªâ giao di·ªán, ch∆∞a submit ƒë·ªÉ kh√¥ng ·∫£nh h∆∞·ªüng t√≠nh nƒÉng c≈©) -->
      <div class="contact-form">
        <h4>Ch√∫ng t√¥i s·∫Ω li√™n h·ªá v·ªõi b·∫°n s·ªõm!</h4>
        <div class="row"><input type="text" placeholder="T√™n c√° nh√¢n / t·ªï ch·ª©c"></div>
        <div class="row"><input type="text" placeholder="S·ªë ƒëi·ªán tho·∫°i"></div>
        <div class="row"><input type="email" placeholder="Email"></div>
        <div class="row"><textarea placeholder="N·ªôi dung"></textarea></div>
        <button type="button" class="send-btn">üì® G·ª≠i</button>
        <p style="margin:10px 0 0; color:#6b7280; font-size:12px;">
          (Form n√†y ƒëang l√† giao di·ªán. N·∫øu b·∫°n mu·ªën l∆∞u v√†o DB/ g·ª≠i mail, m√¨nh s·∫Ω l√†m th√†nh US ri√™ng ƒë·ªÉ kh√¥ng ƒë·ª•ng t√≠nh nƒÉng c≈©.)
        </p>
      </div>
    </div>
  </div>

</section>
{% endblock %}
